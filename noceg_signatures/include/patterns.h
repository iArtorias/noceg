/*
 * This software is licensed under the NoCEG Non-Commercial Copyleft License.
 *
 * Copyright (C) 2025 iArtorias <iartorias.re@gmail.com>
 *
 * You may use, copy, modify, and distribute this software non-commercially only.
 * If you distribute binaries or run it as a service, you must also provide
 * the full source code under the same license.
 *
 * This software is provided "as is", without warranty of any kind.
 *
 * Full license text available in LICENSE.md
 */

#pragma once

// CEG protected function patterns. Includes both constant and stolen/masked functions.
constexpr std::array<std::string_view, 12> CEG_PROTECT_PATTERNS =
{
    "55 8B EC ?? EC ?? 53 56 57 8D 4D ?? E8 ?? ?? ?? ?? 8B 3D",
    "55 8B EC ?? EC ?? ?? ?? ?? 53 56 57 8D 8D ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 3D",
    "55 8B EC ?? EC ?? 56 57 8D 4D ?? E8 ?? ?? ?? ?? 8B 3D",
    "55 8B EC ?? EC ?? ?? ?? ?? 56 57 8D 8D ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 3D",
    "83 EC ?? 53 56 57 8D ?? ?? ?? E8 ?? ?? ?? ?? 8B 3D",
    "83 EC ?? 56 57 8D ?? ?? ?? E8 ?? ?? ?? ?? 8B 3D",
    "81 EC ?? ?? ?? ?? 53 56 57 8D ?? ?? ?? E8 ?? ?? ?? ?? 8B 3D",
    "83 EC ?? 56 57 8D ?? ?? ?? E8 ?? ?? ?? ?? 8B 3D",
    "81 EC ?? ?? ?? ?? 56 57 8D ?? ?? ?? E8 ?? ?? ?? ?? 8B 3D",
    "83 EC ?? 53 56 57 8B 3D ?? ?? ?? ?? 8D BF ?? ?? ?? ?? 8B DF",
    "83 EC ?? 6A ?? 6A ?? 68 ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? ?? FF 15 ?? ?? ?? ?? 85 C0",
    "81 EC ?? ?? ?? ?? 53 56 57 8D ?? ?? ?? ?? ?? ?? 6A ?? 50 C7 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? E8"
};


// CEG integrity patterns.
constexpr std::array<std::string_view, 5> CEG_INTEGRITY_PATTERNS =
{
    "53 56 57 8B 3D ?? ?? ?? ?? 6A ?? 6A ?? B3 01",
    "53 56 57 8B 3D ?? ?? ?? ?? B3 01 8D",
    "A1 ?? ?? ?? ?? 85 C0 8B 0D ?? ?? ?? ?? 8B 15",
    "A1 ?? ?? ?? ?? 8B 0D ?? ?? ?? ?? 8B ?? ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 85 C0",
    "B8 ?? ?? ?? ?? B9 ?? ?? ?? ?? BA ?? ?? ?? ?? 56 0F BE"
};


// CEG test secret patterns. Includes both file and registry.
constexpr std::array<std::string_view, 31> CEG_TESTSECRET_PATTERNS =
{
    "55 8B EC 81 EC ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 0D ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? ?? 89 ?? ?? E8 ?? ?? ?? ?? 84 C0 75",
    "81 EC ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 0D ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? ?? ?? ?? ?? 89 ?? ?? ?? 89 ?? ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 84 C0 75",
    "55 8B EC 81 EC ?? ?? ?? ?? 8B 0D ?? ?? ?? ?? A1 ?? ?? ?? ?? 53 56 8B ?? ?? ?? ?? ?? 57",
    "56 8B ?? E8 ?? ?? ?? ?? F6 ?? ?? ?? ?? 74 ?? 6A ?? 56 E8 ?? ?? ?? ?? 83 C4 ?? 8B ?? 5E C2 04 00 B0 01 C3",
    "55 8B EC ?? EC ?? ?? ?? ?? 53 56 57 8B 3D ?? ?? ?? ?? 8D",
    "55 8B EC 83 ?? ?? ?? ?? ?? ?? ?? ?? 53 56 57 E8 ?? ?? ?? ?? 84 C0 75 ?? B0 01 ?? ?? ?? ?? ?? ?? C3",
    "55 8B EC 83 ?? ?? ?? ?? ?? ?? ?? ?? 53 56 57 E8 ?? ?? ?? ?? 84 C0 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 ?? ?? B0 01 ?? ?? ?? ?? ?? ?? C3",
    "55 8B EC ?? EC ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 53 56 57",
    "55 8B EC ?? EC ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 56 57",
    "55 8B EC 83 ?? ?? ?? EC ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 53 56 57",
    "55 8B EC 83 ?? ?? ?? EC ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 56 57",
    "55 8B EC B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 53 56 57",
    "55 8B EC B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 56 57",
    "B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 53 55 56 57",
    "B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 8B 15 ?? ?? ?? ?? 53 56 57",
    "55 8B EC ?? EC ?? ?? ?? ?? E8 ?? ?? ?? ?? 84 C0 75 ?? B0 01 ?? ?? ?? C3",
    "55 8B EC B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 84 C0 75 ?? B0 01 ?? ?? ?? C3",
    "83 EC ?? 53 56 57 8D ?? ?? ?? B3 01",
    "81 EC ?? ?? ?? ?? 53 56 57 8D ?? ?? ?? B3 01",
    "81 EC ?? ?? ?? ?? 53 56 57 8D ?? ?? ?? ?? ?? ?? B3 01",
    "83 EC ?? 53 56 57 8B 3D ?? ?? ?? ?? B3 01 C7",
    "83 EC ?? 53 6A ?? 6A ?? 68 ?? ?? ?? ?? B3 01 C7 ?? ?? ?? ?? ?? ?? ?? FF 15 ?? ?? ?? ?? 85 C0",
    "55 8B EC ?? EC ?? ?? ?? ?? E8 ?? ?? ?? ?? 84 C0 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 C4 ?? B0 01 ?? ?? ?? C3",
    "55 8B EC B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 84 C0 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 C4 ?? B0 01 ?? ?? ?? C3",
    "83 EC ?? E8 ?? ?? ?? ?? 84 C0 75 ?? B0 01 83 C4 ?? C3",
    "B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 84 C0 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 C4 ?? B0 01 81 C4 ?? ?? ?? ?? C3",
    "B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 84 C0 75 ?? B0 01 81 C4 ?? ?? ?? ?? C3",
    "81 EC ?? ?? ?? ?? E8 ?? ?? ?? ?? 84 C0 75 ?? B0 01 81 C4 ?? ?? ?? ?? C3",
    "51 A1 ?? ?? ?? ?? 56 57 BE ?? ?? ?? ?? ?? ?? ?? ?? 8D 44 24",
    "56 83 ?? ?? 8B ?? E8 ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? 89 ?? ?? C7 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? B0 01 ?? C3",
    "E8 ?? ?? ?? ?? 83 ?? ?? 8B ?? C7 ?? ?? ?? ?? ?? 89 ?? ?? C7 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? B0 01 C3",
};


// CEG initialization patterns.
constexpr std::array<std::string_view, 11> CEG_INIT_LIBRARY_FUNC_PATTERNS =
{
    "E8 ?? ?? ?? ?? 85 C0 A3 ?? ?? ?? ?? 74 ?? E8 ?? ?? ?? ?? 35 ?? ?? ?? ?? 74 ?? B8 01 00 00 00 C3 33 C0 C3",
    "68 ?? ?? ?? ?? 6A 01 FF 15 ?? ?? ?? ?? A3 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 85 C0 A3 ?? ?? ?? ?? 74 ?? E8 ?? ?? ?? ?? B9 ?? ?? ?? ?? 35 ?? ?? ?? ?? 81 F1 ?? ?? ?? ?? 0B C1 74 ?? B8 01 00 00 00 C3 33 C0 C3",
    "E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 85 C0 A3 ?? ?? ?? ?? 74 ?? E8 ?? ?? ?? ?? B9 ?? ?? ?? ?? 35 ?? ?? ?? ?? 81 F1 ?? ?? ?? ?? 0B C1 74 ?? B8 01 00 00 00 C3 33 C0 C3",
    "E8 ?? ?? ?? ?? 85 C0 A3 ?? ?? ?? ?? 74 ?? E8 ?? ?? ?? ?? B9 ?? ?? ?? ?? 35 ?? ?? ?? ?? 81 F1 ?? ?? ?? ?? 0B C1 74 ?? B8 01 00 00 00 C3 33 C0 C3",
    "55 8B EC 83 EC ?? 53 56 57 E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B F0 E8 ?? ?? ?? ?? 8B F8 E8 ?? ?? ?? ?? 8B D8 E8 ?? ?? ?? ?? 89 45 ?? E8",
    "E8 ?? ?? ?? ?? 85 C0 5F 5E A3 ?? ?? ?? ?? 5B 74 ?? E8 ?? ?? ?? ?? BA ?? ?? ?? ?? 35 ?? ?? ?? ?? 81 F2 ?? ?? ?? ?? 0B C2 74 ?? B8 01 00 00 00 8B E5 5D C3 33 C0 8B E5 5D C3",
    "E8 ?? ?? ?? ?? 84 C0 75 ?? C3 E8 ?? ?? ?? ?? 84 C0 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 C4 ?? 53 E8 ?? ?? ?? ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 04 85 C0 0F 94 C3 E8 ?? ?? ?? ?? 84 DB A3 ?? ?? ?? ?? 75 ?? 6A 00 6A 00 E8 ?? ?? ?? ?? 83 C4 08 83 3D ?? ?? ?? ?? ?? 74 ?? E8 ?? ?? ?? ?? B9 ?? ?? ?? ?? 35 ?? ?? ?? ?? 81 F1 ?? ?? ?? ?? 0B C1 74 ?? 84 DB 74 ?? B8 01 00 00 00 5B C3 33 C0 5B C3",
    "E8 ?? ?? ?? ?? 84 C0 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 C4 ?? 53 E8 ?? ?? ?? ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 04 85 C0 0F 94 C3 E8 ?? ?? ?? ?? 84 DB A3 ?? ?? ?? ?? 75 ?? 6A 00 6A 00 E8 ?? ?? ?? ?? 83 C4 08 83 3D ?? ?? ?? ?? ?? 74 ?? E8 ?? ?? ?? ?? B9 ?? ?? ?? ?? 35 ?? ?? ?? ?? 81 F1 ?? ?? ?? ?? 0B C1 74 ?? 84 DB 74 ?? B8 01 00 00 00 5B C3 33 C0 5B C3",
    "53 E8 ?? ?? ?? ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 04 85 C0 0F 94 C3 E8 ?? ?? ?? ?? 84 DB A3 ?? ?? ?? ?? 75 ?? 6A 00 6A 00 E8 ?? ?? ?? ?? 83 C4 08 83 3D ?? ?? ?? ?? ?? 74 ?? E8 ?? ?? ?? ?? B9 ?? ?? ?? ?? 35 ?? ?? ?? ?? 81 F1 ?? ?? ?? ?? 0B C1 74 ?? 84 DB 74 ?? B8 01 00 00 00 5B C3 33 C0 5B C3",
    "A1 ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 83 C4 ?? 84 C0 75 ?? C3 E8 ?? ?? ?? ?? 84 C0 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 C4 ?? 53 E8 ?? ?? ?? ?? 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? 85 C0 0F 94 C3 E8 ?? ?? ?? ?? A3 ?? ?? ?? ?? 84 DB 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 C4 ?? 83 3D ?? ?? ?? ?? ?? 74 ?? E8 ?? ?? ?? ?? 85 C0 74 ?? 84 DB 74 ?? B8 01 00 00 00 5B C3", // Newer CEG with allocated buffers.
    "E8 ?? ?? ?? ?? 84 C0 74 ?? E8 ?? ?? ?? ?? 84 C0 74 ?? A1 ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 83 C4 ?? 84 C0 74 ?? E8 ?? ?? ?? ?? 84 C0 75 ?? 6A ?? 6A ?? E8 ?? ?? ?? ?? 83 C4 ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? A3 ?? ?? ?? ?? 85 C0 74 ?? E8 ?? ?? ?? ?? 85 C0 74 ?? B8 01 00 00 00 C3" // Newer CEG with allocated buffers.
};


// CEG register thread patterns.
constexpr std::array<std::string_view, 2> CEG_REGISTER_THREAD_FUNC_PATTERNS =
{
    "56 E8 ?? ?? ?? ?? 8B F0 E8 ?? ?? ?? ?? 50 56 E8 ?? ?? ?? ?? 83 C4 ?? E8 ?? ?? ?? ?? A3 ?? ?? ?? ?? E8 ?? ?? ?? ?? A3 ?? ?? ?? ?? B0 01",
    "56 E8 ?? ?? ?? ?? 8B F0 E8 ?? ?? ?? ?? 50 56 E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? A3 ?? ?? ?? ?? E8 ?? ?? ?? ?? 6A ?? A3 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? B0 01"
};


// CEG terminate patterns.
constexpr std::array<std::string_view, 5> CEG_TERM_LIBRARY_FUNC_PATTERNS =
{
    "A1 ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 8B 0D ?? ?? ?? ?? 83 C4 ?? 51 FF 15 ?? ?? ?? ?? A1 ?? ?? ?? ?? 85 C0 74 ?? 50 FF 15 ?? ?? ?? ?? B0 01 C7 05 ?? ?? ?? ?? ?? ?? ?? ?? C3",
    "A1 ?? ?? ?? ?? 85 C0 74 ?? 50 FF 15 ?? ?? ?? ?? B0 01 C7 05 ?? ?? ?? ?? ?? ?? ?? ?? C3",
    "A1 E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 0D ?? ?? ?? ?? 83 C4",
    "56 E8 ?? ?? ?? ?? 8B F0 E8 ?? ?? ?? ?? 50 56 68",
    "A1 ?? ?? ?? ?? 50 FF 15 ?? ?? ?? ?? A1"
};